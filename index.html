<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
      <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
	    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.5.1.min.js"></script>
	    <script type="text/javascript">
	        Bokeh.set_log_level("info");
	    </script>
      <py-config>
		packages = ['pandas', 'joblib','scikit-learn','matplotlib','numpy','bokeh']
		[[fetch]]
		from = 'https://raw.githubusercontent.com/cmd-ml/iii.eg.zb.github.io/main/Ridge_Eg.pkl'
		name = 'eg'
		[[fetch]]
		from = 'https://raw.githubusercontent.com/cmd-ml/iii.eg.zb.github.io/main/Ridge_Ex.pkl'
		name = 'ex'
      </py-config>
  </head>
  <body>
    <h1 style="color:blue;text-align:center;">ML predictor of the Bandgap of the III-V Senary Zincblende Semiconductors</h1>
    <div class="split left">
    	<div class="centered">
		    <pre><b>Select the desired molar fraction configuration by moving the sliding button</b>
		    	Configuration: <i>Al<sub>x<sub>1</sub></sub> Ga<sub>x<sub>2</sub></sub> In<sub>x<sub>3</sub></sub> P<sub>y<sub>1</sub></sub> As<sub>y<sub>2</sub></sub> Sb<sub>y<sub>3</sub></sub></i></pre>
		    <div id="UserInput1" style="float:left; width: 25%;">
		    	<pre><b>The mole faraction of cations</b></pre>
			    <p>Element: Al</p>
			    <input type="range" id="num1" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>x</i><sub>1</sub>: <span id="x1"></span></p>
			    <p>Element: Ga</p>
			    <input type="range" id="num2" min="0" max="1.0" value="1" step="0.01"/>
			    <p>Molar Fraction <i>x</i><sub>2</sub>: <span id="x2"></span></p>
			    <p>Element: In</p>
			    <input type="range" id="num3" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>x</i><sub>3</sub>: <span id="x3"></span></p>
			  </div>
			  <div id="UserInput2" style="float:left; width: 25%;">
			  	<pre><b>The mole faraction of anions</b></pre>
			    <p>Element: P</p>
			    <input type="range" id="num4" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>y</i><sub>1</sub>: <span id="y1"></span></p>
			    <p>Element: As</p>
			    <input type="range" id="num5" min="0" max="1.0" value="1" step="0.01"/>
			    <p>Molar Fraction <i>y</i><sub>2</sub>: <span id="y2"></span></p>
			    <p>Element: Sb</p>
			    <input type="range" id="num6" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>y</i><sub>3</sub>: <span id="y3"></span></p>
			  </div>

		    <div id="c6cd95dc-a59c-4b1f-929f-503067c818f5" data-root-id="p1333" style="display: contents; float:right; width: 50%;"></div>
		  
		    <script type="application/json" id="a8b5e3ac-8a75-472a-9a69-45fa41a7f9a8">
		      {"9dd4f257-4c81-409a-a14f-fbf260d7366a":{"version":"3.5.1","title":"Bokeh Application","roots":[{"type":"object","name":"Figure","id":"p1333","attributes":{"width":500,"height":500,"x_range":{"type":"object","name":"Range1d","id":"p1342"},"y_range":{"type":"object","name":"DataRange1d","id":"p1335"},"x_scale":{"type":"object","name":"LinearScale","id":"p1343"},"y_scale":{"type":"object","name":"LinearScale","id":"p1344"},"title":{"type":"object","name":"Title","id":"p1340"},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1375","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1369","attributes":{"selected":{"type":"object","name":"Selection","id":"p1370","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1371"},"data":{"type":"map","entries":[["x",[0.0,0.05263157894736842,0.10526315789473684,0.15789473684210525,0.21052631578947367,0.2631578947368421,0.3157894736842105,0.3684210526315789,0.42105263157894735,0.47368421052631576,0.5263157894736842,0.5789473684210527,0.631578947368421,0.6842105263157894,0.7368421052631579,0.7894736842105263,0.8421052631578947,0.894736842105263,0.9473684210526315,1.0]],["y",[0.3590906312410388,0.38607122076391276,0.4163507470805219,0.4499298921684548,0.4868093380053006,0.526989766568648,0.5704718598360863,0.6172562997852041,0.6673437683935907,0.7207349476388347,0.7774305194985254,0.8374311659502516,0.9007375689716021,0.9673504105401658,1.037270372633532,1.1104981372292895,1.1870343863050272,1.2668798018383338,1.3500350658067988,1.436500860188011]]]}}},"view":{"type":"object","name":"CDSView","id":"p1376","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1377"}}},"glyph":{"type":"object","name":"Line","id":"p1372","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"blue","line_alpha":0.8,"line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1373","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"blue","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1374","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"blue","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p1386","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1380","attributes":{"selected":{"type":"object","name":"Selection","id":"p1381","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1382"},"data":{"type":"map","entries":[["x",[0.0,0.05263157894736842,0.10526315789473684,0.15789473684210525,0.21052631578947367,0.2631578947368421,0.3157894736842105,0.3684210526315789,0.42105263157894735,0.47368421052631576,0.5263157894736842,0.5789473684210527,0.631578947368421,0.6842105263157894,0.7368421052631579,0.7894736842105263,0.8421052631578947,0.894736842105263,0.9473684210526315,1.0]],["y",[1.3699847242127288,1.3635050121532248,1.3609041240169877,1.3621818859100572,1.367338123938473,1.376372664208275,1.389285332825503,1.4060759558961968,1.426744359526396,1.4512903698221404,1.47971381288947,1.5120145148344244,1.5481923017630432,1.5882469997813664,1.6321784349954338,1.679986433511285,1.73167082143496,1.7872314248724985,1.8466680699299403,1.909980582713325]]]}}},"view":{"type":"object","name":"CDSView","id":"p1387","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1388"}}},"glyph":{"type":"object","name":"Line","id":"p1383","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"red","line_alpha":0.8,"line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1384","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"red","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1385","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"red","line_alpha":0.2,"line_width":2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1341","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1355"},{"type":"object","name":"WheelZoomTool","id":"p1356","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1357","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1358","attributes":{"syncable":false,"line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","handles":{"type":"object","name":"BoxInteractionHandles","id":"p1364","attributes":{"all":{"type":"object","name":"AreaVisuals","id":"p1363","attributes":{"fill_color":"white","hover_fill_color":"lightgray"}}}}}}}},{"type":"object","name":"SaveTool","id":"p1365"},{"type":"object","name":"ResetTool","id":"p1366"},{"type":"object","name":"HelpTool","id":"p1367"},{"type":"object","name":"HoverTool","id":"p1368","attributes":{"renderers":"auto","tooltips":[["Mole","$x"],["Eg","$y"]]}}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1350","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1351","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1352"},"axis_label":"Enegy [eV]","major_label_policy":{"type":"object","name":"AllLabels","id":"p1353"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1345","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1346","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1347"},"axis_label":"Mole Fraction [x]","major_label_policy":{"type":"object","name":"AllLabels","id":"p1348"}}}],"center":[{"type":"object","name":"Grid","id":"p1349","attributes":{"axis":{"id":"p1345"}}},{"type":"object","name":"Grid","id":"p1354","attributes":{"dimension":1,"axis":{"id":"p1350"}}},{"type":"object","name":"Legend","id":"p1378","attributes":{"location":"top_left","click_policy":"hide","items":[{"type":"object","name":"LegendItem","id":"p1379","attributes":{"label":{"type":"value","value":"Gamma"},"renderers":[{"id":"p1375"}]}},{"type":"object","name":"LegendItem","id":"p1389","attributes":{"label":{"type":"value","value":"X"},"renderers":[{"id":"p1386"}]}}]}}]}}]}}
		    </script>
		    <script type="text/javascript">
		      (function() {
		        const fn = function() {
		          Bokeh.safely(function() {
		            (function(root) {
		              function embed_document(root) {
		              const docs_json = document.getElementById('a8b5e3ac-8a75-472a-9a69-45fa41a7f9a8').textContent;
		              const render_items = [{"docid":"9dd4f257-4c81-409a-a14f-fbf260d7366a","roots":{"p1333":"c6cd95dc-a59c-4b1f-929f-503067c818f5"},"root_ids":["p1333"]}];
		              root.Bokeh.embed.embed_items(docs_json, render_items);
		              }
		              if (root.Bokeh !== undefined) {
		                embed_document(root);
		              } else {
		                let attempts = 0;
		                const timer = setInterval(function(root) {
		                  if (root.Bokeh !== undefined) {
		                    clearInterval(timer);
		                    embed_document(root);
		                  } else {
		                    attempts++;
		                    if (attempts > 100) {
		                      clearInterval(timer);
		                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
		                    }
		                  }
		                }, 10, root)
		              }
		            })(window);
		          });
		        };
		        if (document.readyState != "loading") fn();
		        else document.addEventListener("DOMContentLoaded", fn);
		      })();
		    </script>

		    <script>
					var slider1 = document.getElementById("num1");
					var output1 = document.getElementById("x1");
					var slider2 = document.getElementById("num2");
					var output2 = document.getElementById("x2");
					var slider3 = document.getElementById("num3");
					var output3 = document.getElementById("x3");
					var slider4 = document.getElementById("num4");
					var output4 = document.getElementById("y1");
					var slider5 = document.getElementById("num5");
					var output5 = document.getElementById("y2");
					var slider6 = document.getElementById("num6");
					var output6 = document.getElementById("y3");
					output1.innerHTML = slider1.value;
					output2.innerHTML = slider2.value;
					output3.innerHTML = slider3.value;
					output4.innerHTML = slider4.value;
					output5.innerHTML = slider5.value;
					output6.innerHTML = slider6.value;

					slider1.oninput = function() {
		  		output1.innerHTML = this.value;
					}
					slider2.oninput = function() {
		  		output2.innerHTML = this.value;
					}
					slider3.oninput = function() {
		  		output3.innerHTML = this.value;
					}
					slider4.oninput = function() {
		  		output4.innerHTML = this.value;
					}
					slider5.oninput = function() {
		  		output5.innerHTML = this.value;
					}
					slider6.oninput = function() {
		  		output6.innerHTML = this.value;
					}
				</script>
		    <button py-click="predictor">Predict</button>
		    <div id="output" style="float:center;"></div>
    	</div>
    </div>
    <py-script>
	from pyscript import document
	import joblib
	import pandas as pd
	import os
	from sklearn.linear_model import Ridge
	import warnings
	warnings.filterwarnings("ignore")

	def predictor(event):
		cwd = os.getcwd()
		files = os.listdir(cwd)
		print("Files in %r: %s" % (cwd,files))
		x1 = document.querySelector("#num1").value
		x2 = document.querySelector("#num2").value
		x3 = document.querySelector("#num3").value
		y1 = document.querySelector("#num4").value
		y2 = document.querySelector("#num5").value
		y3 = document.querySelector("#num6").value
		Ridge_Eg_Gamma = joblib.load('Ridge_Eg.pkl','r') # For Gamma Valley
		feature=pd.DataFrame({'Al':[x1],'Ga':[x2],'In':[x3],'P':[y1],'As':[y2],'Sb':[y3]})
		eg = Ridge_Eg_Gamma.predict(feature)[0]
		Ridge_Eg_X     = joblib.load('Ridge_Ex.pkl','r')  # For X Valley
		output_div = document.querySelector("#output")
		output_div.innerText = eg
    </py-script>
  </body>
</html>

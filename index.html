<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
      <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
      <py-config>
		packages = ['pandas', 'joblib','scikit-learn','matplotlib','numpy','bokeh']
		[[fetch]]
		from = 'https://raw.githubusercontent.com/cmd-ml/iiiv.eg.zb.github.io/main/Ridge_Eg.pkl'
		name = 'eg'
		[[fetch]]
		from = 'https://raw.githubusercontent.com/cmd-ml/iiiv.eg.zb.github.io/main/Ridge_Ex.pkl'
		name = 'ex'
      </py-config>
  </head>
  <body>
    <h1 style="color:blue;text-align:center;">ML predictor of the Bandgap of the III-V Senary Zincblende Semiconductors</h1>
    <div class="split left">
    	<div class="centered">
		    <pre><b>Select the desired molar fraction configuration by moving the sliding button</b>
		    	Configuration: <i>Al<sub>x<sub>1</sub></sub> Ga<sub>x<sub>2</sub></sub> In<sub>x<sub>3</sub></sub> P<sub>y<sub>1</sub></sub> As<sub>y<sub>2</sub></sub> Sb<sub>y<sub>3</sub></sub></i></pre>
		    <div id="UserInput1" style="float:left; width: 25%;">
		    	<pre><b>The mole faraction of cations</b></pre>
			    <p>Element: Al</p>
			    <input type="range" id="num1" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>x</i><sub>1</sub>: <span id="x1"></span></p>
			    <p>Element: Ga</p>
			    <input type="range" id="num2" min="0" max="1.0" value="1" step="0.01"/>
			    <p>Molar Fraction <i>x</i><sub>2</sub>: <span id="x2"></span></p>
			    <p>Element: In</p>
			    <input type="range" id="num3" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>x</i><sub>3</sub>: <span id="x3"></span></p>
			  </div>
			  <div id="UserInput2" style="float:left; width: 25%;">
			  	<pre><b>The mole faraction of anions</b></pre>
			    <p>Element: P</p>
			    <input type="range" id="num4" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>y</i><sub>1</sub>: <span id="y1"></span></p>
			    <p>Element: As</p>
			    <input type="range" id="num5" min="0" max="1.0" value="1" step="0.01"/>
			    <p>Molar Fraction <i>y</i><sub>2</sub>: <span id="y2"></span></p>
			    <p>Element: Sb</p>
			    <input type="range" id="num6" min="0" max="1.0" value="0" step="0.01"/>
			    <p>Molar Fraction <i>y</i><sub>3</sub>: <span id="y3"></span></p>
			  </div>
		    <script>
					var slider1 = document.getElementById("num1");
					var output1 = document.getElementById("x1");
					var slider2 = document.getElementById("num2");
					var output2 = document.getElementById("x2");
					var slider3 = document.getElementById("num3");
					var output3 = document.getElementById("x3");
					var slider4 = document.getElementById("num4");
					var output4 = document.getElementById("y1");
					var slider5 = document.getElementById("num5");
					var output5 = document.getElementById("y2");
					var slider6 = document.getElementById("num6");
					var output6 = document.getElementById("y3");
					output1.innerHTML = slider1.value;
					output2.innerHTML = slider2.value;
					output3.innerHTML = slider3.value;
					output4.innerHTML = slider4.value;
					output5.innerHTML = slider5.value;
					output6.innerHTML = slider6.value;

					slider1.oninput = function() {
		  		output1.innerHTML = this.value;
					}
					slider2.oninput = function() {
		  		output2.innerHTML = this.value;
					}
					slider3.oninput = function() {
		  		output3.innerHTML = this.value;
					}
					slider4.oninput = function() {
		  		output4.innerHTML = this.value;
					}
					slider5.oninput = function() {
		  		output5.innerHTML = this.value;
					}
					slider6.oninput = function() {
		  		output6.innerHTML = this.value;
					}
				</script>
		    <button py-click="predictor">Predict</button>
		    <div id="output" style="float:center;"></div>
    	</div>
    </div>
    <py-script>
	from pyscript import document
	import joblib
	import pandas as pd
	import os
	from sklearn.linear_model import Ridge
	import warnings
	warnings.filterwarnings("ignore")

	def predictor(event):
		cwd = os.getcwd()
		files = os.listdir(cwd)
		print("Files in %r: %s" % (cwd,files))
		x1 = document.querySelector("#num1").value
		x2 = document.querySelector("#num2").value
		x3 = document.querySelector("#num3").value
		y1 = document.querySelector("#num4").value
		y2 = document.querySelector("#num5").value
		y3 = document.querySelector("#num6").value
		Ridge_Eg_Gamma = joblib.load('Ridge_Eg.pkl','r') # For Gamma Valley
		feature=pd.DataFrame({'Al':[x1],'Ga':[x2],'In':[x3],'P':[y1],'As':[y2],'Sb':[y3]})
		eg = Ridge_Eg_Gamma.predict(feature)[0]
		Ridge_Eg_X     = joblib.load('Ridge_Ex.pkl','r')  # For X Valley
		output_div = document.querySelector("#output")
		output_div.innerText = eg
    </py-script>
  </body>
</html>
